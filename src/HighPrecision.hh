#pragma once

#include <map>
#include <stack>
#include <vector>
#include <string>
#include <iostream>


namespace HighPrecisionCalculator
{

	class HighPrecisionNumber
	{
	protected:
		std::vector<char> integerDigits;		//存储整数部分（倒序）
		std::vector<char> decimalDigits;		//存储小数部分（倒序）
		bool isNegative;						//存储符号（true为负）

	public:
		//构造函数
		explicit HighPrecisionNumber();
		explicit HighPrecisionNumber(const int);
		explicit HighPrecisionNumber(const double);
		explicit HighPrecisionNumber(const long long);
		explicit HighPrecisionNumber(const std::string&);
		explicit HighPrecisionNumber(const unsigned long long);

		//奇偶性
		bool IsOdd()const;

		//向下取整
		HighPrecisionNumber floor()const;

		//去掉小数
		HighPrecisionNumber deldec()const;

		//阶乘
		HighPrecisionNumber factorial()const;

		//重载运算符

		//取负
		friend HighPrecisionNumber operator - (const HighPrecisionNumber&);

		//加减乘除  取余  乘方
		friend HighPrecisionNumber operator + (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend HighPrecisionNumber operator - (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend HighPrecisionNumber operator * (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend HighPrecisionNumber operator / (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend HighPrecisionNumber operator % (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend HighPrecisionNumber operator ^ (const HighPrecisionNumber&, const HighPrecisionNumber&);

		template<typename T> friend HighPrecisionNumber operator + (const HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber operator - (const HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber operator * (const HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber operator / (const HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber operator % (const HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber operator ^ (const HighPrecisionNumber&, const T&);

		template<typename T> friend HighPrecisionNumber operator + (const T&, const HighPrecisionNumber&);
		template<typename T> friend HighPrecisionNumber operator - (const T&, const HighPrecisionNumber&);
		template<typename T> friend HighPrecisionNumber operator * (const T&, const HighPrecisionNumber&);
		template<typename T> friend HighPrecisionNumber operator / (const T&, const HighPrecisionNumber&);
		template<typename T> friend HighPrecisionNumber operator % (const T&, const HighPrecisionNumber&);
		template<typename T> friend HighPrecisionNumber operator ^ (const T&, const HighPrecisionNumber&);

		//十进制移位
		friend HighPrecisionNumber operator << (const HighPrecisionNumber&, const int);
		friend HighPrecisionNumber operator >> (const HighPrecisionNumber&, const int);

		//赋值运算
		template<typename T> HighPrecisionNumber operator = (const T& t);
		template<typename T> friend HighPrecisionNumber& operator += (HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber& operator -= (HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber& operator *= (HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber& operator /= (HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber& operator %= (HighPrecisionNumber&, const T&);
		template<typename T> friend HighPrecisionNumber& operator ^= (HighPrecisionNumber&, const T&);
		friend HighPrecisionNumber& operator <<= (HighPrecisionNumber&, const int);
		friend HighPrecisionNumber& operator >>= (HighPrecisionNumber&, const int);

		//逻辑运算
		friend bool operator ! (const HighPrecisionNumber&);
		friend bool operator == (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend bool operator != (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend bool operator > (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend bool operator < (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend bool operator >= (const HighPrecisionNumber&, const HighPrecisionNumber&);
		friend bool operator <= (const HighPrecisionNumber&, const HighPrecisionNumber&);

		template<typename T> friend bool operator == (const HighPrecisionNumber&, const T&);
		template<typename T> friend bool operator != (const HighPrecisionNumber&, const T&);
		template<typename T> friend bool operator > (const HighPrecisionNumber&, const T&);
		template<typename T> friend bool operator < (const HighPrecisionNumber&, const T&);
		template<typename T> friend bool operator >= (const HighPrecisionNumber&, const T&);
		template<typename T> friend bool operator <= (const HighPrecisionNumber&, const T&);

		template<typename T> friend bool operator == (const T&, const HighPrecisionNumber&);
		template<typename T> friend bool operator != (const T&, const HighPrecisionNumber&);
		template<typename T> friend bool operator > (const T&, const HighPrecisionNumber&);
		template<typename T> friend bool operator < (const T&, const HighPrecisionNumber&);
		template<typename T> friend bool operator >= (const T&, const HighPrecisionNumber&);
		template<typename T> friend bool operator <= (const T&, const HighPrecisionNumber&);

		//流IO
		friend std::ostream& operator << (std::ostream&, const HighPrecisionNumber&);
		friend std::istream& operator >> (std::istream&, HighPrecisionNumber&);

		//求倒数
		friend HighPrecisionNumber reciprocal(const HighPrecisionNumber&);

		//求lg
		friend HighPrecisionNumber lg(const HighPrecisionNumber&);

		//求10^x
		friend HighPrecisionNumber pow10(const HighPrecisionNumber&);

		//整数指数快速幂
		friend HighPrecisionNumber FastPow(const HighPrecisionNumber&, const HighPrecisionNumber&);

	private:
		//删除多余的0
		void trim();

	};




	class HighPrecisionExpression
	{
	protected:
		std::stack<HighPrecisionNumber> constant;
		std::stack<std::string> operation;
		std::string expressionstr;

	public:

		explicit HighPrecisionExpression();
		explicit HighPrecisionExpression(const std::string&);

		bool calculate();

		friend bool operator == (const HighPrecisionExpression&, const std::string&);
		friend bool operator != (const HighPrecisionExpression&, const std::string&);

		friend bool operator == (const std::string&, const HighPrecisionExpression&);
		friend bool operator != (const std::string&, const HighPrecisionExpression&);

		friend std::ostream& operator << (std::ostream&, const HighPrecisionExpression&);
		friend std::istream& operator >> (std::istream&, HighPrecisionExpression&);

		void clear();

	private:

		bool cal(const std::string&);

	};

	const HighPrecisionNumber ln10("2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058498078280597511938544450099781311469159346662410718466923101075984383191912922307925037472986509290098803919417026544168163357275557031515961135648465461908970428197633658369837163289821744073660091621778505417792763677311450417821376601110107310423978325218948988175979217986663943195239368559164471182467532456309125287783309636042629821530408745609277607266413547875766162629265682987049579549139549180492090694385807900327630179415031178668620924085379498612649334793548717374516758095370882810674524401058924449764796860751202757241818749893959716431055188481952883307466993178146349300003212003277656541304726218839705967944579434683432183953044148448037013057536742621536755798147704580314136377932362915601281853364984669422614652064599420729171193706024449293580370077189810973625332245483669885055282859661928050984471751985036666808749704969822732202448233430971691111368135884186965493237149969419796878030088504089796185987565798948364452120436982164152929878117429733325886079159125109671875109292484750239305726654462762009230687915181358034777012955936462984123664970233551745861955647724618577173693684046765770478743197805738532718109338834963388130699455693993461010907456160333122479493604553618491233330637047517248712763791409243983318101647378233796922656376820717069358463945316169494117018419381194054164494661112747128197058177832938417422314099300229115023621921867233372683856882735333719251034129307056325444266114297653883018223840910261985828884335874559604530045483707890525784731662837019533922310475275649981192287427897137157132283196410034221242100821806795252766898581809561192083917607210809199234615169525990994737827806481280587927319938934534153201859697110214075422827962982370689417647406422257572124553925261793736524344405605953365915391603125244801493132345724538795243890368392364505078817313597112381453237015084134911223243909276817247496079557991513639828810582857405380006533716555530141963322419180876210182049194926514838926922937078986352706385027022697551249943004381827884731992196581431219760711108763412244664073779455588583919440809311024283085084746319069321981468643083555347651114650769097333395832575068277582831051803299481308483996817211366798801920377706868547950620358417219984374394106362343231481174552475640089192165491269082781506048171199070188629209822862716730477199015770285357910506284673372232400018795615022890843967414685656483176881389206840957969180335433913646786574590549488029854381988073595542704154087340145317392545367328193997645602559843243305615873500293280257230645327034811810847231164468047519194264144375548657693929296834286675851067319241918228522689913893119216944242303851706529337045121498383597940218271629133640253154959691311714663534422264568544683226289253198527399466669571860157929838504401537461528275128857545617541969976789089211724902376347878942402183376781397354658345556295079309046680515976409505248189475873099476612986320677356531111786061537481010815864277211113500176661091149696494183076946301388416026503178481192972380206808689623654396591512067607905008319523024347817883038778471028263055912430624394315691194617233215130478320894258513052642518211479848258424730967079501644395520063137114248500249765290151310380216416843468036623965040057852031727464634148889412770388318760666904172965971359908177369006347894595288976221997880798271398331815395541572978947016728750253235908278131635706663489567636634400113009800938783592130026295307123674302232399707337986684151718246888145657647721175116367797327505183074902665362406067789612931306854975874330548536937665630316711117871564571156402499783053492289780268464608192132840314804827498936970373280933145401019276483406059371514185798933564159483238353253287520100855555015928089183326808993683275161374389819736125706679627161789820168085761103706608215753270001344145799883900770905779094769333871859305574516372163922302788546884992191747753620135740007380802900346480128950506385687149679702782421339869036664769242138722104747932942674694063112638491014361807287766080410512512203857794290637730069124170742882066979861077774302450430789578007873940273257119728212361207957714181867478395175738044597888766309263535332561183535891639650303833404777193733442095669020535984663348283042430767205765885022263704399245813786912612910050862966339808643426856706538613996143539313531483614247934686121473700807141967542133230591398542242736296026835252707454330860376309325759906527931853695952152915790405269385849244062500718796054882446358568358413714733580707756729985326427735317760670765957691014899255065615965724284308760962751475401096713288805825291009414132370624302010898937948541901428716311211438780592832747736394221535425581125164164617665061633826060708786432495934451088742301059691162233864858109313925605573164788595221777415620114648944672391572247882432944846662113928463874193715350804510211018170040998675939589632761524137751011977989522830733147458719084125149128845320329292331889907799972401724198363495403071487492456079023987837044095908189182931318932267101779615883646066016098310338061418288332139895255915139242322429525610918912551474352545267536813785157099205423655668625119889469097891271437839883994404234836623253992113693237393384087357256422102227674072360194115308610349855598008431436298107955203128631532660207271975693753721028575367353104216556458025694603960404313069427014164857524792785136184205453163867281631759378424417717388698381203126982893906235029995046555574802126604990886895208354986807114405225574597018845999987451244974665697321228916979294225917554074302518422506957313727724662714125608114101554710203063484420740118595090777856920631848716983718742667040069571921733340732613951656672326480329303022421188067185119138574488850452631801426873701868174823202011163535031850208975299309933054826170382952855386281755632968663290011210779886921289244661329295417448133163224462493224407826572186888602202803446835097471499946590197305727983187629873155611744885012602366975787150787870810140242326057382998271167957775940139250524607966633255251045774231008341836904213434670150373525245838356143371692672183495388289218359751499688711343808120074364193799939646710986259399319148195651492560980637030630448483156653622926767447054252158852436425331334494111751193450823720142019368551826071657479995604224220373863948942382566342712928728229321371933658050193103288279879097922251654544086990681202072607645862728026643519108533691769369353560212633772746051218081581729300545505033898713185842257727243084979762893029412827008915920113315171697714103700306103623971794621822999949376728095144417951595380244313046020561305623405774440809435543562539610251806557916937912879789632022348607588753293592853852605418419130415182279636867054943203269837819503267751534625644637510226145993842871041651001086982320890071147035158794051261295950286447499446432602757180053078402418240005489949370709539478856774170483693024988900857190446195551864121301283311420169264368304770205943951221471895975165451685554194848303143408510932777786371507942785778250390193741844365203060887670598183598820852935292812133308207381640367330684551932633941469431981317241131960875461690877511182817522094183995392721239436436617720278877457153731271938984863459902796343934012227704935207493194341126536676243200568561146997235207021034466057653056905868926923324775179079597733404131178185670193996565545717754759328189684629785362524295633129686108307603155133332564127570834713871459980652297494460869269946464609614184996978920397987382885032071731979264727523098337096671280819001207766935705882861817815812551673491385905636950041631039957269233434554007420775114289094963707252676275134331440799539662646385953338158417387721448103619997290036860006189589227151080877887680109653132728970383651164763616245337418713523408511704067426091506202162207362868244635556704952884981933391300995638482463358675941130712452558556886569808336592090687945314787836754320194593272607793204853641636733444425114518077059880807989070279740212266267978426378637652297680090691556101948016024914255091395886423205210082797751801449825416163778941552444904378354179074659135860627947990894581991635752282689806096152994281469566042756581265421949517796584972463270602702975982699071046168751289335200931500276306011821377353850649498537050528236551662667240750416484267524703310312540153499715634682432552665805434540570456375305998661938429070133467937570418997892432954029962560178385770919735025933598794923197452860625376663314119693821289513736438582362373883661925958390943833902831314096702698215329920010671144622845226894328758962744557472550036445369732768621419958991235972013417747312058321980923585092170334490465082217797663679431204834061116285659611027939635246492518889371263839901417251962409864260561053450472040201533719616964952283040814694992185855352288301226079725168825821808894082905790283476196429635491705854527783750790411390637181488339");

	const HighPrecisionNumber reciln10("0.4342944819032518276511289189166050822943970058036665661144537831658646492088707747292249493384317483187061067447663037336416792871589639065692210646628122658521270865686703295933708696588266883311636077384905142844348666768646586085135561482123487653435434357317253835622281395603048646652366095539377356176323431916710991411597894962993512457934926357655469077671082419150479910989674900103277537653570270087328550951731440674697951899513594088040423931518868108402544654089797029863286828762624144013457043546132920600712605104028367125954846287707861998992326748439902348171535934551079475492552482577820679220140931468164467381030560475635720408883383209488996522717494541331791417640247407505788767860971099257547730046048656049515610057985741340272675201439247917970859047931285212493341197329877226463885350226083881626316463883553685501768460295286399391633510647555704050513182342988874882120643595023818902643317711537382203362634416478397146001858396093006317333986134035135741787144971453076492968331392399810608505734816169809280016199523523117237676561989228127013815804248715978344927215947562057179993483814031940166771520104787197582531617951490375597514246570736646439756863149325162498727994852637448791165959219701720662704559284657036462635675733575739369673994570909602526350957193468839951236811356428010958778313759442713049980643798750414472095974872674060160650105375287000491167867133309154761441005054775930890767885596533432190763128353570304854020979941614010807910607498871752495841461303867532086001324486392545573072842386175970677989354844570318359336523016027971626535726514428519866063768635338181954876389161343652374759465663921380736144503683797876824369028804493640496751871720614130731804417180216440993200651069696951247072666224570004229341407923361685302418860272411867806272570337552562870767696632173672454758133339263840130320038598899947332285703494195837691472090608812447825078736711573033931565625157907093245370450744326623349807143038059581776957944070042202545430531910888982754062263600601879152267477788232096025228766762416332296812464502577295040226623627536311798532153780883272326920785980990757434437367248710355853306546581653535157943990070326436222520010336980419843015524524173190520247212241110927324425302930200871037337504867498689117225672067268275246578790446735268575794059983346595878592624978725380185506389602375304294539963737367434680767515249986297676732404903363175488195323680087668648666069282082342536311304939972702858872849086258458687045569244548538607202497396631126372122497538854967981580284810494724140453341192674240839673061167234256843129624666246259542760677182858963306586513950932049023032806357536242804315480658368852257832901530787483141985929074121415344772165398214847619288406571345438798607895199435011532826457742311266817183284968697890904324421005272233475053141625981646457044538901148313760708445483457955728303866473638468537587172210685993933008378534367552699899185150879055911525282664002892347937881121407895555195374408772295866252736746195639280603742726018616689670312012663117696913355706331630849577406356406229544498141403602074278756296665237541703118888983326952979459481210760848339634648644578297380492018939593886450713530024251256429146752636965688118790367526300650703432024423641454042942756681159988708670742574270248887466031356154482731009059311783482476274672791911930315614087348515809602788857832461865544654766307340625511354958708319564665767428807303231693426738727205599774366566529764447395141032833942918472472974321114019358087391109026762802963420497065078011899433838008080132868909397172465029499287660721651780984955411231009057182178892113097407890171554042645169832090273444520463039848823570143978006332330954882686175070447049618001348968372301641740437719913516171210181685548502811752314858971337587901923152484509079359066533916615589936769871036713763268689563891273495175161631796453225380319832428353970970623980284544713857277032427692338387873041312636525221126106093060752992030645096844169711465638074719985864264878644555193681313493997768075370028036024119728783045170876588640557274222898045184194495971154337684449500375878822631988769253208536691125509225218187312393277190049382097378497872783140532034411259469402102495126766408527000824078549191015654613505763051777155024580852073990996723946987968358210406781250157789270921046764448617822017096378924405984125146522842779108272140383674135124864245915091815340922639427082875668985698356822677628524958196454993061713856777006002238553957911602032480336612702055015863475646838924124592112055929324405726099371912880655651226464328758822074225247037795086602908776833119806840511399446881155342324981337347844120983456946922255832231935667026543657151456765841719852590093095753594653700397628552739046785908520751976630545537855996781584342820849035683293975038081324535967378709052619102863080979412995879726862061437759787027312460562248130999359000460491855815371755229660375838102214077454998581218937727750474740350081611351495555827274287815042722142159066568275563951252881072633687915551290579461533213661234613307913094497411606460476944972407308576179088626086990053572344073772243952195706907051471543030649919167646660810350301543918340266544820511283258938482965646574152877108216191815070945416918816648708173817283866184696427804338592874848836712713885948748864256059629364373661193990338149294178869165655374371442251631510166956971318821537197078712762884509197718168539981181059708755940544576804025044314332832831430871398001355984742003322031419736452286069042183496762953590253271894720408894319132940392623473338953132838790937271913997336484386213799985197853073623484964873618297478967112046001599027695576711653642561655403661720533824847627504146190883933360535112877665847840440539788207369894895192544143121649275598929857083871039693921736581776140467076979427096257367400115859131308388639108136090627487138248529212821388899542557705951136325163564238761792535832656673730284632572389062056245816270065726554205787201071090666206626412259785715726497258159394455170268034822889883355664394579731947330905133757533689694106552046919252622325971173955311030220143860013645909941894196550186707428069984819039517227296901396250522075278390149933850689043374851246590647239774928651529080900687768030075825808765463251365676764590035302266538226679332805986027416329691045896153216890334699278232922747692522724510531881188608149686661029586079983109571243311111136703558201442758677463267533379937282469741978656733889064212498629490651699806547109556383558645617376326352513467259156605637097570330430298309670510512932537022018937130362557170359270033203147096402393470466689273772068014572464007330886920833703527978171189284453904626682244618397973373927027547650393721303159537669610228026513108652561635267752392911156397269253200337327732651480762984196386990970037051231347676932558410764809565649691065994722563246444084139740887376362675998643358444409236407158968222922526883441351369846055953461472384203055619836604223325716542986733025072958040186749048134902616520869194942729372751478165759530003443737123738900711731696993174599500402765634745460852127935825138545288998964508152139014305709442198082222844750917655276585717383896188471891549154053075648170135810037345783987887106249203482444397797936823325957257539309416996616849544758942503514661498620386592655018048209921956623977940042612721633582165927285990414441689159125763750229499700475524521989227077375120515537886094209260377139410252378259199158851020982674486846935899156506301972465035918027218245522165063116635129584338154700194607813844361250394917322858544724881840914997412163974731143921948600233007299580549336293464543014481168617266973167365854178899663320878828996479915877440457514561635149137156365957808691837337305824634957868107967986869563983316428498499175438366670681950735900835555555098227258961111546747741673538483065436241120467433046364471190556457877274105222914928684872810621244972985691677798922697171237639561695711608771927043334781072020711310447332649984861886158785264456570763285437524238870028067765616856749437532740825414174523267969279665154935964576290561576290960910728892464994113126120683944015232333047320687296219334246831871033829061240602259873026296842899755603033060752804209240054061380796216145758088991883549479017815949053547662454174014091942815432692050761033498837068226015630824198163368941632839760353569420646191716402983862818993745607891920188139606938952856793000598026030484044348356626852225309624071442293251144977907695417093225046459679855937346760896200494075170639354378182978391633925350516415780554964318568236067139673830262920040074126859416917979854683274547215108335594419627982851841683015169780258476487252959663442173867827889982482402937970248944079314028347338610449247024985367163423758006786205884292414701030885176343394370559656368945302825955691519349270321340530591363088504126752179950925104939236441706864304067072262989050227651250328838389992886189896376699606425296084198174234614547060650019208088789571272965005387424959797174771976999752036165714401605581106675964026387196448990028958176179465026995283418314314409825114671990010709602520578518622579825956071617261293752097207209840604760531345560736369209294087359279685939198716872787778415596266773814234555011232965753278885250126309373532351682844683066802303911555187649455564413477352576255661761777185809894708122694186881687278459151058474743799837778392070518396052180919532236209918934013062799345578286845781720141179903393928233249001393543656693822876577905721174281877774455620009671770127034567543582705147686388376600560313349373869893679217924572684392354493529556138514726316963937677107924534846123803983444588563473236994103402283586214821365369634570047687539488822909173980177272887823849541200982148428346057148240302171650827798215085153754117950457804854754744047625297552891737646787318730598852");

	const HighPrecisionNumber lg2("0.3010299956639811952137388947244930267681898814621085413104274611271081892744245094869272521181861720406844771914309953790947678811335235059996923337046955750645029642541934026618197343116029435011839028981785826171544395318619290463538846995202393108496124625404002633125946214788458473182826726839823261965427935076313175483509271389649469177857689180507900075995480878154597145850319648776261224922908291181909514989971716198604776765000678205179125573286286683420004029205098370845722248954942975621497072446597086136896092219094827612143914965282351678264923148040277462432441633115387382593038830393806332161302390518805821319156854616929053015051319269853784884187183200657535694683929717421320109058968908505856246409872183968766485398562351612773026389278782608498366810303084314155608139436176745488566634245381237339324224695943490602120445042968274606884785461156847684106437979500465969917745657540864018464079456529544341077408293999745400737217016801948890554856910694003754116899634157592972180644303810281520339238808563319868545398739354856065784289684898261394426084663278295260287662127623043419220262891211208361260055836862548999990927948784319747443388868629117713157413143222824169072995854725266157016837865324843772484501494231070981057547644239111166946914554653158213087545714859155264064669459397387274662626481556373135327269337959696802462363735803701702786527871382368266749519828884623367557462306447793364776980371470683133258881873131213864740296038784183570677840989672932230922836364090201677037161827336928454087218080144771762625506953476160886796962493766575320443448687953289293925355111468317252267269027574480678023768175534837405704382181223225333167896207975599032293059759674720866648423041739237925998625349797830939557939058531037975252143068778805590617344892191109026025826773307573559257888422877792921036753407863490855304794891954127419184995998472002896512482522900747644463235884208906503954959958558491035115048492721824049807454415599714989477887378682500728795922343009822942319249669491417573912540823496553976533413869724203094173675384196617867099578338970272787004639974872240934753017262827760378370041738228863589377924969862382325875180463298232538546590341884426607227746447936272479903769129333465546000093551695582424858532028918059736125384801823233442382103597678824131039216641326364909236929561097306295842230012701617892390833049660856580781673692318563832584839462208652330228807179187192362489333183015077311070745689121796914659367263135893208011259762354377304084068691237128559812760223428004379482876405125056913303826126403010530544273522458755389426282403514202977818574552152384456959363447034603700075088301735463847438537626403813454101438397158618878510933055522612438895685859314545981789398788095813097703294418454997539675584688521519928980078439477852749940693683296260337646969514281916547101134848280981159903891701632260198003335883343845347382837025678023183861865130506220796140649616517197441983362605251249435462333474207868218516919591009545367794107815920360973936616374249119974637581407388959127815667522795364331554404420540179775764574548045169358698557713498962599996338712463484916662006552612443129250273097705761564363331480979397586382101639153876281396221678652701621851872329327455199084359964370192229850163095316713600207495922820916926549406462015648516454839158198784522132330450566129638573974937494273361127741513842401000629562952191501261421723765087475239349268709954310991407339846379648623541205877052582157001940121088265053862420946239876135632219151395413745173865916851509644153119575878656498662100238893693108780943450508528466234382177343457889029398133355035174777008710821292356848678620539535720276545541790537872530502710701062170715088910526887959903910530278900868819684174003550490801852363346534150842598678778631295494252602029777067177633226348596208208829274740456372779701472755638788190784400976456870008457883700266813011923206196333878215846040733449263503651051191101403011098782737057847279051316748366723261946119583261254532331540082169467108602701774149967693998249375944746613415141940937550395825843753055648927667101895651619038987222872412515120827394231098838148110137700373589185088874278779534287441592376164595033359658544255003228496766069439226201365430030307203732941074253166516150071412099801810271374497152572160724936646388358103014272780662675943334687260374453743660278272231417303451308357309209362616142054838218146333065315091278414476738378702180988507713216007040367249564728981580033352751469842058022763578119395310334763014144567478637357245580977734937548656939871977977315313337061476862581811862090009206963058344298650460787460029116278906607159634540062737510043368937894881220447411369266695950881395070346377853955421429076370515177102397208455954664489465247862964017040292074927058690719427438246930579064937588750183750703884457234427176240789769116941152012358710805055511735985961521629659405149542528915695955364841351726871348743563342080085760395901723385754688206153274639939549351161075101927656721136437254856506254611463222256880615324720084145852382238890785837765248907173111341650512147876470730970489116197617093858302503305849581101121504565131969764125547918601293547835394401182547837133332286054405356855492490245434708371160091400645641010196802942338217903086164689994345045278524508239311392238465212326190551845924418111314893088540601032585980305127338200705109115230504792377109529732190028025764004059137691978116406217431868624988213475992415657066420261323827207806039547734050897256926007031993499918162369714033636981248973742426654473059686727414390407460882440515586486730005801544006569549555421152828347445060487069447997528971739451418994559379807029685774262364686454897336537102097165601784231357313276095051082662967197110061901064320744390505026043592293054669935647732588381521137672881333780786726554557248189040442459671076802369388082315183854624067985205745376589142625465227654361975144629639061857480794605151881398743854253797577849296638098437322140907600868110433667700123985774973736596986684753627281658550303493228285652349911568985711586625298830173991173920937722170195728579436856228842293201394341037379841733346331457863946409747754472604901415326285182529793843190669901489519994141910823172146228063020285235770595009501977708096548252259090282651194848329180456216167976476286963317658951051778600708783916750621003917822334120790264600470044560790747335459063921492148464330285608789907953708805384410435134164628331734222758835583946159746401439620194985713498176916447994412813714281838514940836026287639961491792281243553692926158515447292989625690979937987129791477286204650869315867131858223273603803065220822848670208661135811869325397336132723558201223604083655750643897432887078086202304074498123191215880788225098396438771638577609130336279917716092308269485124942676675293225060948275950086968570786289625540447452707208686059692942372255188177857897096662442157266624061773729257955065578366922863113845544906178978920438144601195916604884954245337527678342896940298870636226089146780573880960881792031540828198855104263279619097355794653747792205470907992601996860805304282430578160730410834257807986472050734636314753370085069784701525752495353598563515150534508360132197029765274031194933665113817758625126283880382777214951894264778499996342530578006397544192963951628524200665648334223091192066370482834680929211343309931722983951903416735686705390903196483763255429275526434059276929728444145130734555265694636952218842323746192550460492868136348107734182143263465340648467737488813236817830810401443086667510521833430362427533289516602998582429506252067680456341772170766205819082161533182188493474286482041621036191973059303060732362130619733656468282296971262673030597380322275439978659606829818683157530316256389688027106280605740239003777533012943030900486949898890263782827411092885938355840380657210797268092891482342348206375424836932019679456968995034002447211968939735481341972337416743519797688481730251024672408952076713655461777156971259334974941897210500373976906735095433988914179406933485967631377204143361108738778442893083037918944370764256354896550857194997985277986138916751877739597592511922913551844714098664171862993642682380656068480911002730321880266614164983171182198291547835336817726275109042460742971623031339464252696559819732974722411952564600019993386652881362728938113620708085246185483391797207145055451333879188823640356556702884340628360727853378460422648325596144952543340955600629219569171086367679128913179508000572805489701142230313708460561229225268299180888001864493384732200661465422936513632253681883072185350802292283956422672732632969985992422806087141830535612839701385677993947948782395557306472916288613132567250664393649137954804350646397527876242225200924596601427176755185451764640313396521110178838490860727956804548173615975448360263158958851520058153026421382702231772218746065152398962272405488498914706741979281683379602344554588917521988050022116838257296131254142080844454035371770460222300772676883856320840226827112216350126508968632984641568461067724738000015493914400293223683218661032048805528681950445757742942117162711526638975851557800104108993616275010761954038116040195556617834775451240079923140748788181851290477242791214248534020217957008646958225012894911716229506711514403190966389613237089835199978134946237607510467101167631775631808371419852453829834215138646145609651088687321504942963870061739697456380103034379719823731337665855197063131674917951963031373564619369164477834843557975058207889079621272231925012150712141547221307773913877305843294562364928283129073157238688181334367923065788092414166810854868709393249342946152465112661687406842415927581551259115524103935194940064451956953472268958143334475057512458559752957017123135046637285476946182638015941411242456024324975723831439850493041949994883421936737116638149496485708828791106546049927228684071450");

	const HighPrecisionNumber e("2.7182818284590452353602874713526624977572470936999595749669676277240766303535475945713821785251664274274663919320030599218174135966290435729003342952605956307381323286279434907632338298807531952510190115738341879307021540891499348841675092447614606680822648001684774118537423454424371075390777449920695517027618386062613313845830007520449338265602976067371132007093287091274437470472306969772093101416928368190255151086574637721112523897844250569536967707854499699679468644549059879316368892300987931277361782154249992295763514822082698951936680331825288693984964651058209392398294887933203625094431173012381970684161403970198376793206832823764648042953118023287825098194558153017567173613320698112509961818815930416903515988885193458072738667385894228792284998920868058257492796104841984443634632449684875602336248270419786232090021609902353043699418491463140934317381436405462531520961836908887070167683964243781405927145635490613031072085103837505101157477041718986106873969655212671546889570350354021234078498193343210681701210056278802351930332247450158539047304199577770935036604169973297250886876966403555707162268447162560798826517871341951246652010305921236677194325278675398558944896970964097545918569563802363701621120477427228364896134225164450781824423529486363721417402388934412479635743702637552944483379980161254922785092577825620926226483262779333865664816277251640191059004916449982893150566047258027786318641551956532442586982946959308019152987211725563475463964479101459040905862984967912874068705048958586717479854667757573205681288459205413340539220001137863009455606881667400169842055804033637953764520304024322566135278369511778838638744396625322498506549958862342818997077332761717839280349465014345588970719425863987727547109629537415211151368350627526023264847287039207643100595841166120545297030236472549296669381151373227536450988890313602057248176585118063036442812314965507047510254465011727211555194866850800368532281831521960037356252794495158284188294787610852639813955990067376482922443752871846245780361929819713991475644882626039033814418232625150974827987779964373089970388867782271383605772978824125611907176639465070633045279546618550966661856647097113444740160704626215680717481877844371436988218559670959102596862002353718588748569652200050311734392073211390803293634479727355955277349071783793421637012050054513263835440001863239914907054797780566978533580489669062951194324730995876552368128590413832411607226029983305353708761389396391779574540161372236187893652605381558415871869255386061647798340254351284396129460352913325942794904337299085731580290958631382683291477116396337092400316894586360606458459251269946557248391865642097526850823075442545993769170419777800853627309417101634349076964237222943523661255725088147792231519747780605696725380171807763603462459278778465850656050780844211529697521890874019660906651803516501792504619501366585436632712549639908549144200014574760819302212066024330096412704894390397177195180699086998606636583232278709376502260149291011517177635944602023249300280401867723910288097866605651183260043688508817157238669842242201024950551881694803221002515426494639812873677658927688163598312477886520141174110913601164995076629077943646005851941998560162647907615321038727557126992518275687989302761761146162549356495903798045838182323368612016243736569846703785853305275833337939907521660692380533698879565137285593883499894707416181550125397064648171946708348197214488898790676503795903669672494992545279033729636162658976039498576741397359441023744329709355477982629614591442936451428617158587339746791897571211956187385783644758448423555581050025611492391518893099463428413936080383091662818811503715284967059741625628236092168075150177725387402564253470879089137291722828611515915683725241630772254406337875931059826760944203261924285317018781772960235413060672136046000389661093647095141417185777014180606443636815464440053316087783143174440811949422975599314011888683314832802706553833004693290115744147563139997221703804617092894579096271662260740718749975359212756084414737823303270330168237193648002173285734935947564334129943024850235732214597843282641421684878721673367010615094243456984401873312810107945127223737886126058165668053714396127888732527373890392890506865324138062796025930387727697783792868409325365880733988457218746021005311483351323850047827169376218004904795597959290591655470505777514308175112698985188408718564026035305583737832422924185625644255022672155980274012617971928047139600689163828665277009752767069777036439260224372841840883251848770472638440379530166905465937461619323840363893131364327137688841026811219891275223056256756254701725086349765367288605966752740868627407912856576996313789753034660616669804218267724560530660773899624218340859882071864682623215080288286359746839654358856685503773131296587975810501214916207656769950659715344763470320853215603674828608378656803073062657633469774295634643716709397193060876963495328846833613038829431040800296873869117066666146800015121143442256023874474325250769387077775193299942137277211258843608715834835626961661980572526612206797540621062080649882918454395301529982092503005498257043390553570168653120526495614857249257386206917403695213533732531666345466588597286659451136441370331393672118569553952108458407244323835586063106806964924851232632699514603596037297253198368423363904632136710116192821711150282801604488058802382031981493096369596735832742024988245684941273860566491352526706046234450549227581151709314921879592718001940968866986837037302200475314338181092708030017205935530520700706072233999463990571311587099635777359027196285061146514837526209565346713290025994397663114545902685898979115837093419370441155121920117164880566945938131183843765620627846310490346293950029458341164824114969758326011800731699437393506966295712410273239138741754923071862454543222039552735295240245903805744502892246886285336542213815722131163288112052146489805180092024719391710555390113943316681515828843687606961102505171007392762385553386272553538830960671644662370922646809671254061869502143176211668140097595281493907222601112681153108387317617323235263605838173151034595736538223534992935822836851007810884634349983518404451704270189381994243410090575376257767571118090088164183319201962623416288166521374717325477727783488774366518828752156685719506371936565390389449366421764003121527870222366463635755503565576948886549500270853923617105502131147413744106134445544192101336172996285694899193369184729478580729156088510396781959429833186480756083679551496636448965592948187851784038773326247051945050419847742014183947731202815886845707290544057510601285258056594703046836344592652552137008068752009593453607316226118728173928074623094685367823106097921599360019946237993434210687813497346959246469752506246958616909178573976595199392993995567542714654910456860702099012606818704984178079173924071945996323060254707901774527513186809982284730860766536866855516467702911336827563107223346726113705490795365834538637196235856312618387156774118738527722922594743373785695538456246801013905727871016512966636764451872465653730402443684140814488732957847348490003019477888020460324660842875351848364959195082888323206522128104190448047247949291342284951970022601310430062410717971502793433263407995960531446053230488528972917659876016667811937932372453857209607582277178483361613582612896226118129455927462767137794487586753657544861407611931125958512655759734573015333642630767985443385761715333462325270572005303988289499034259566232975782488735029259166825894456894655992658454762694528780516501720674785417887982276806536650641910973434528878338621726156269582654478205672987756426325321594294418039943217000090542650763095588465895171709147607437136893319469090981904501290307099566226620303182649365733698419555776963787624918852865686607600566025605445711337286840205574416030837052312242587223438854123179481388550075689381124935386318635287083799845692619981794523364087429591180747453419551420351726184200845509170845682368200897739455842679214273477560879644279202708312150156406341341617166448069815483764491573900121217041547872591998943825364950514771379399147205219529079396137621107238494290616357604596231253506068537651423115349665683715116604220796394466621163255157729070978473156278277598788136491951257483328793771571459091064841642678309949723674420175862269402159407924480541255360431317992696739157542419296607312393763542139230617876753958711436104089409966089471418340698362993675362621545247298464213752891079884381306095552622720837518629837066787224430195793793786072107254277289071732854874374355781966511716618330881129120245204048682200072344035025448202834254187884653602591506445271657700044521097735585897622655484941621714989532383421600114062950718490427789258552743035221396835679018076406042138307308774460170842688272261177180842664333651780002171903449234264266292261456004337383868335555343453004264818473989215627086095650629340405264943244261445665921291225648893569655009154306426134252668472594914314239398845432486327461842846655985332312210466259890141712103446084271616619001257195870793217569698544013397622096749454185407118446433946990162698351607848924514058940946395267807354579700307051163682519487701189764002827648414160587206184185297189154019688253289309149665345753571427318482016384644832499037886069008072709327673127581966563941148961716832980455139729506687604740915420428429993541025829113502241690769431668574242522509026939034814856451303069925199590436384028429267412573422447765584177886171737265462085498294498946787350929581652632072258992368768457017823038096567883112289305809140572610865884845873101658151167533327674887014829167419701512559782572707406431808601428149024146780472327597684269633935773542930186739439716388611764209004068663398856841681003872389214483176070116684503887212364367043314091155733280182977988736590916659612402021778558854876176161989370794380056663364884365089144805571039765214696027662583599051987042300179465536789");


}